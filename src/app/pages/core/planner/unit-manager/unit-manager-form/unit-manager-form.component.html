@if (coreService.isLoading) {
    <app-skeleton [type]="SkeletonEnum.CARD"></app-skeleton>
  }

  @if (!coreService.isLoading) {
    <p-toolbar>
      <div class="p-toolbar-group-left">
        <app-header-form [id]="id"></app-header-form>
      </div>
      <div class="p-toolbar-group-right">
        <button pButton pRipple type="button"
                (click)="back()"
                [icon]="IconButtonActionEnum.CANCEL"
                [label]="LabelButtonActionEnum.CANCEL"
                [loading]="coreService.isLoading"
                [ngClass]="[ClassButtonActionEnum.CANCEL]"></button>
        <p-divider layout="vertical"></p-divider>
        <button pButton pRipple type="button"
                (click)="onSubmit()"
                [icon]="IconButtonActionEnum.SAVE"
                [label]="LabelButtonActionEnum.SAVE"
                [loading]="coreService.isLoading"
                [ngClass]="[ClassButtonActionEnum.SAVE]"></button>
      </div>
    </p-toolbar>

    <p-panel class="p-fluid">
      <form [formGroup]="form" (ngSubmit)="onSubmit()">
        <div class="formgrid grid">
          <div class="field xl:col-4 lg:col-4 md:col-4 sm:col-12">
            <label appLabel for="user" [label]="UnitManagersFormEnum.user"
                   [required]="userField"></label>
            <p-dropdown id="user"
                        dataKey="id"
                        formControlName="user"
                        [options]="users"
                        optionLabel="name"
                        [filter]="true"
                        filterBy="name"
                        placeholder="Seleccione...">
              <ng-template pTemplate="selectedItem">
                @if (userField.value) {
                  <div>{{ userField.value.name }}</div>
                }
              </ng-template>
              <ng-template let-item pTemplate="item">
                <div>{{ item.name }}</div>
              </ng-template>
            </p-dropdown>
            <small appErrorMessage
                   [errors]="userField.errors"
                   [touched]="userField.touched"
                   [dirty]="userField.dirty">
            </small>
          </div>
          <div class="field xl:col-4 lg:col-4 md:col-4 sm:col-12">
            <label appLabel for="role" [label]="UnitManagersFormEnum.role"
                   [required]="roleField"></label>
            <p-dropdown id="role"
                        dataKey="id"
                        formControlName="role"
                        [options]="roles"
                        optionLabel="name"
                        [filter]="true"
                        filterBy="name"
                        placeholder="Seleccione...">
              <ng-template pTemplate="selectedItem">
                @if (roleField.value) {
                  <div>{{ roleField.value.name }}</div>
                }
              </ng-template>
              <ng-template let-item pTemplate="item">
                <div>{{ item.name }}</div>
              </ng-template>
            </p-dropdown>
            <small appErrorMessage
                   [errors]="roleField.errors"
                   [touched]="roleField.touched"
                   [dirty]="roleField.dirty">
            </small>
          </div>
          <div class="field xl:col-4 lg:col-4 md:col-4 sm:col-12">
            <label appLabel for="unit" [label]="UnitManagersFormEnum.unit"
                   [required]="unitField"></label>
            <p-dropdown id="unit"
                        dataKey="id"
                        formControlName="unit"
                        [options]="units"
                        optionLabel="name"
                        [filter]="true"
                        filterBy="name"
                        placeholder="Seleccione...">
              <ng-template pTemplate="selectedItem">
                @if (unitField.value) {
                  <div>{{ unitField.value.name }}</div>
                }
              </ng-template>
              <ng-template let-item pTemplate="item">
                <div>{{ item.name }}</div>
              </ng-template>
            </p-dropdown>
            <small appErrorMessage
                   [errors]="unitField.errors"
                   [touched]="unitField.touched"
                   [dirty]="unitField.dirty">
            </small>
          </div>
        </div>
        <div class="formgrid grid">
          <div class="field xl:col-5 lg:col-5 md:col-5 sm:col-12">
            <label appLabel for="code" [label]="UnitManagersFormEnum.code" [required]="codeField"></label>
            <input pInputText type="text" id="code" formControlName="code"/>
            <small appErrorMessage
                   [errors]="codeField.errors"
                   [touched]="codeField.touched"
                   [dirty]="codeField.dirty">
            </small>
          </div>
          <div class="field xl:col-5 lg:col-5 md:col-5 sm:col-12">
            <label appLabel for="date" [label]="UnitManagersFormEnum.date" [required]="dateField"></label>
            <input pInputText type="text" id="date" formControlName="date"/>
            <small appErrorMessage
                   [errors]="dateField.errors"
                   [touched]="dateField.touched"
                   [dirty]="dateField.dirty">
            </small>
          </div>
          <div class="field xl:col-2 lg:col-2 md:col-2 sm:col-12">
            <label appLabel for="enabled" [label]="UnitManagersFormEnum.enabled" [required]="enabledField"></label>
            <p>
              <p-inputSwitch id="enabled" formControlName="enabled"></p-inputSwitch>
            </p>
            <small appErrorMessage [errors]="enabledField.errors" [touched]="enabledField.touched"
              [dirty]="enabledField.dirty">
            </small>
          </div>
        </div>
      </form>
    </p-panel>
  }

  <p-overlayPanel #opIdentification>
    <ng-template pTemplate="content">
      Ingrese su numero cedula
    </ng-template>
  </p-overlayPanel>

  <p-overlayPanel #opEmail>
    <ng-template pTemplate="content">
      Ingrese su correo
    </ng-template>
  </p-overlayPanel>
