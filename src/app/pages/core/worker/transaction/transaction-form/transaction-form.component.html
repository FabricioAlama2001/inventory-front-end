@if (coreService.isLoading) {
<app-skeleton [type]="SkeletonEnum.CARD"></app-skeleton>
} @if (!coreService.isLoading) {
<p-toolbar>
  <div class="p-toolbar-group-left">
    <app-header-form [id]="id"></app-header-form>
  </div>
  <div class="p-toolbar-group-right">
    <button
      pButton
      pRipple
      type="button"
      (click)="back()"
      [icon]="IconButtonActionEnum.CANCEL"
      [label]="LabelButtonActionEnum.CANCEL"
      [loading]="coreService.isLoading"
      [ngClass]="[ClassButtonActionEnum.CANCEL]"
    ></button>

    <p-divider layout="vertical"></p-divider>

    <button
      pButton
      pRipple
      type="button"
      (click)="onSubmit()"
      [icon]="IconButtonActionEnum.SAVE"
      [label]="LabelButtonActionEnum.SAVE"
      [loading]="coreService.isLoading"
      [ngClass]="[ClassButtonActionEnum.SAVE]"
    ></button>
  </div>
</p-toolbar>

<p-panel class="p-fluid">
  <form [formGroup]="form" (ngSubmit)="onSubmit()">
    <!-- <div class="field">
      <label appLabel for="category" label="Categoría" [required]="categoryField"></label>
      <p-dropdown
        id="category"
        dataKey="id"
        formControlName="category"
        [filter]="true"
        [options]="categories"
        optionLabel="name"
        placeholder="Seleccione...">
      </p-dropdown>
      <small
        appErrorMessage
        [errors]="categoryField.errors"
        [touched]="categoryField.touched"
        [dirty]="categoryField.dirty"
      >
      </small>
    </div> -->

    <div class="formgrid grid">
      <!-- Drop de tipos (Ingresos e ingresos) -->
      <div class="field xl:col-4 lg:col-3 md:col-12 sm:col-12">
        <label appLabel for="type" label="Tipo" [required]="typeField"></label>

        <p-dropdown
          id="type"
          formControlName="type"
          [options]="types"
          optionLabel="name"
          placeholder="Seleccione..."
        >
        </p-dropdown>
        <small
          appErrorMessage
          [errors]="typeField.errors"
          [touched]="typeField.touched"
          [dirty]="typeField.dirty"
        >
        </small>
      </div>

      <!-- Drop de Authorizer -->
      <div class="field xl:col-4 lg:col-3 md:col-12 sm:col-12">
        <label
          appLabel
          for="user"
          label="Autorizador"
          [required]="userField"
        ></label>
        <p-dropdown
          id="user"
          dataKey="id"
          formControlName="user"
          [filter]="true"
          [options]="users"
          optionLabel="name"
          placeholder="Seleccione..."
        >
        </p-dropdown>
        <small
          appErrorMessage
          [errors]="userField.errors"
          [touched]="userField.touched"
          [dirty]="userField.dirty"
        >
        </small>
      </div>

      <!-- Drop de proveedor -->
      @if(typeField.valid){
      <div class="field xl:col-4 lg:col-3 md:col-12 sm:col-12">
        <label
          appLabel
          for="user"
          [label]="client"
          [required]="userField"
        ></label>
        <p-dropdown
          id="user"
          dataKey="id"
          formControlName="client"
          [filter]="true"
          [options]="clients"
          optionLabel="name"
          placeholder="Seleccione..."
        >
        </p-dropdown>
        <small
          appErrorMessage
          [errors]="userField.errors"
          [touched]="userField.touched"
          [dirty]="userField.dirty"
        >
        </small>
      </div>
      }
      <!-- Codigo -->
      <div class="field xl:col-6 lg:col-3 md:col-12 sm:col-12">
        <label
          appLabel
          for="code"
          label="Código"
          [required]="codeField"
        ></label>
        <input pInputText type="text" id="code" formControlName="code" />
        <small
          appErrorMessage
          [errors]="codeField.errors"
          [touched]="codeField.touched"
          [dirty]="codeField.dirty"
        >
        </small>
      </div>
      <!--Date -->
      <div class="field xl:col-6 lg:col-3 md:col-6 sm:col-12">
        <label
          appLabel
          for="date"
          label="Fecha de transaccion: (yyyy-mm-dd)"
          [required]="dateField"
        ></label>
        <p-calendar
          id="date"
          formControlName="date"
          dateFormat="yy-mm-dd"
          [firstDayOfWeek]="1"
          [showIcon]="true"
        ></p-calendar>
        <small
          appErrorMessage
          [errors]="dateField.errors"
          [touched]="dateField.touched"
          [dirty]="dateField.dirty"
        >
        </small>
      </div>
    </div>
    <div class="formgrid grid">
      <!-- Descripcion -->
      <div class="field xl:col-12 lg:col-12 md:col-12 sm:col-12">
        <label
          appLabel
          for="description"
          label="Descripción"
          [required]="descriptionField"
        ></label>
        <textarea
          pInputTextarea
          id="description"
          formControlName="description"
        ></textarea>
        <small
          appErrorMessage
          [errors]="descriptionField.errors"
          [touched]="descriptionField.touched"
          [dirty]="descriptionField.dirty"
        >
        </small>
      </div>
    </div>
  </form>
</p-panel>
}

<!-- Hola mundo -->
<p-overlayPanel #opDate>
  <ng-template pTemplate="content"> Ingrese la fecha de ingreso </ng-template>
</p-overlayPanel>

<p-overlayPanel #opDate>
  <ng-template pTemplate="content"> Ingrese la fecha de ingreso </ng-template>
</p-overlayPanel>

<p-overlayPanel #opType>
  <ng-template pTemplate="content"> Elija el tipo de ingreso </ng-template>
</p-overlayPanel>
